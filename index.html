<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>üçÅ Maple Panel</title>
  <style>
    :root {
      --maple-primary: #9d4edd;
      --maple-secondary: #7209b7;
      --maple-accent: rgba(157, 78, 221, 0.3);
      --bg-top: #1a0d2e;
      --bg-mid: #16213e;
      --bg-bot: #0f0f23;
      --text: #e4e6ea;
      --muted: #9ca3af;
      --border: #4c4f69;
      --card-bg: #1e1a2e;
      --card-shadow: rgba(0,0,0,0.5);
      --error: #e74c3c;
    }
    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      font-family: 'Segoe UI', Tahoma, Verdana, sans-serif;
      color: var(--text);
      background: linear-gradient(135deg, var(--bg-top), var(--bg-mid) 50%, var(--bg-bot));
      min-height:100vh;
    }
    .container {
      max-width: 1000px;
      margin: auto;
      padding: 20px;
    }
    header {
      text-align: center;
      margin-bottom: 1.5rem;
    }
    .logo {
      width: 60px;
      height: 60px;
      margin: 0 auto .5rem;
      background: url('maple-leaf.svg') center/contain no-repeat;
      filter: drop-shadow(0 0 8px var(--maple-accent));
    }
    h1 {
      font-size: 2rem;
      background: linear-gradient(135deg, var(--maple-primary), var(--maple-secondary));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    #connectSection {
      display: grid;
      gap: .75rem;
      max-width: 360px;
      margin: 0 auto 2rem;
    }
    #connectSection input,
    #connectSection button {
      width: 100%;
      padding: 12px;
      border-radius: 6px;
      border: 1px solid var(--border);
      background: rgba(30,26,46,0.8);
      color: var(--text);
    }
    #connectSection button {
      border: none;
      background: linear-gradient(135deg, var(--maple-primary), var(--maple-secondary));
      font-weight: 600;
      cursor: pointer;
      transition: transform .15s, box-shadow .15s;
    }
    #connectSection button:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px var(--card-shadow);
    }
    .status {
      font-size: .9rem;
      text-align: center;
      min-height: 1.2em;
    }
    nav.tabs {
      display: flex;
      border-bottom: 2px solid var(--border);
      gap: 1rem;
      margin-bottom: 1rem;
      justify-content: center;
      visibility: hidden;
    }
    nav.tabs button {
      padding: .75rem 1.5rem;
      background: none;
      border: none;
      color: var(--muted);
      cursor: pointer;
      position: relative;
      font-size: 1rem;
    }
    nav.tabs button.active {
      color: var(--maple-primary);
    }
    nav.tabs button.active::after {
      content: '';
      position: absolute;
      bottom: -2px; left: 0; right: 0;
      height: 3px;
      background: var(--maple-primary);
      border-radius: 2px 2px 0 0;
    }
    section.tab-content {
      display: none;
      animation: fadeIn .3s ease-in-out;
    }
    section.tab-content.active {
      display: block;
    }
    @keyframes fadeIn {
      from { opacity: 0 }
      to { opacity: 1 }
    }
    .two-col {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1rem;
    }
    .card {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 1rem;
      box-shadow: 0 2px 6px var(--card-shadow);
      display: flex;
      flex-direction: column;
      gap: .5rem;
    }
    .card h3 {
      margin-bottom: .5rem;
      font-size: 1.1rem;
      color: var(--maple-primary);
    }
    .list {
      list-style: none;
      overflow-y: auto;
      max-height: 200px;
      padding-right: .5rem;
    }
    .list li {
      padding: .5rem;
      border-radius: 4px;
      cursor: pointer;
      transition: background .2s;
    }
    .list li:hover {
      background: var(--maple-accent);
    }
    textarea {
      width: 100%;
      padding: .75rem;
      background: rgba(30,26,46,0.8);
      border: 1px solid var(--border);
      border-radius: 6px;
      color: var(--text);
      resize: vertical;
    }
    input[type=number] {
      padding: .5rem;
      border-radius: 6px;
      border: 1px solid var(--border);
      background: rgba(30,26,46,0.8);
      color: var(--text);
      text-align: center;
    }
    .switch {
      display: inline-flex;
      align-items: center;
      gap: .5rem;
    }
    .switch input {
      width: 1.5rem;
      height: .8rem;
      -webkit-appearance: none;
      background: var(--border);
      border-radius: 4px;
      position: relative;
      cursor: pointer;
      outline: none;
      transition: background .2s;
    }
    .switch input:checked {
      background: var(--maple-primary);
    }
    .switch input::before {
      content: '';
      position: absolute;
      top: 2px; left: 2px;
      width: .75rem; height: .75rem;
      background: #fff;
      border-radius: 50%;
      transition: transform .2s;
    }
    .switch input:checked::before {
      transform: translateX(.7rem);
    }
    @media (max-width: 768px) {
      .two-col { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="logo"></div>
      <h1>üçÅ Maple Panel</h1>
    </header>

    <!-- TOKEN CONNECT -->
    <div id="connectSection">
      <input id="tokenInput" type="password" placeholder="Discord Token"/>
      <button onclick="connect()">Connect</button>
      <div id="connectStatus" class="status"></div>
    </div>

    <!-- TABS -->
    <nav class="tabs" id="tabs">
      <button class="active" data-tab="serversTab">Servers & Channels</button>
      <button data-tab="multiTab">Multi-Channel</button>
      <button data-tab="replyTab">Auto-Reply</button>
    </nav>

    <!-- SERVERS & CHANNELS -->
    <section id="serversTab" class="tab-content active">
      <div class="two-col">
        <div class="card">
          <h3>Your Servers</h3>
          <ul id="serverList" class="list">
            <!-- filled via JS -->
          </ul>
        </div>
        <div class="card">
          <h3>Channels in <span id="currentServerName">‚Ä¶</span></h3>
          <ul id="channelList" class="list">
            <!-- filled via JS -->
          </ul>
        </div>
      </div>
    </section>

    <!-- MULTI-CHANNEL -->
    <section id="multiTab" class="tab-content">
      <div class="card">
        <h3>Broadcast Settings</h3>
        <div id="selectedChannels" style="margin-bottom:1rem;color:var(--muted);">
          No channels selected
        </div>
        <button onclick="selectChannels()">Pick Channels</button>
        <div class="two-col" style="margin:1rem 0;">
          <input id="waveCount" type="number" value="1" min="1" placeholder="Waves" />
          <input id="multiplier" type="number" value="1" min="1" placeholder="Multiplier" />
        </div>
        <button onclick="broadcast()">Start Broadcast</button>
        <div id="broadcastStatus" class="status"></div>
      </div>
    </section>

    <!-- AUTO-REPLY -->
    <section id="replyTab" class="tab-content">
      <div class="card">
        <h3>Auto-Reply</h3>
        <label class="switch">
          <input id="autoReplyToggle" type="checkbox"/>
        </label>
        <textarea id="autoReplyMsgs" rows="4" placeholder="One reply per line‚Ä¶"></textarea>
        <button onclick="updateAutoReply()">Update</button>
        <div id="replyStatus" class="status"></div>
      </div>
    </section>

  </div>

  <script>
    // Tab switching
    document.querySelectorAll('nav.tabs button').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('nav.tabs button').forEach(b=>b.classList.remove('active'));
        document.querySelectorAll('section.tab-content').forEach(c=>c.classList.remove('active'));
        btn.classList.add('active');
        document.getElementById(btn.dataset.tab).classList.add('active');
      });
    });

    // Real connect & populate servers
    async function connect() {
      const token = tokenInput.value.trim();
      if (!token) {
        connectStatus.textContent = 'Enter your token first';
        connectStatus.style.color = 'var(--error)';
        return;
      }
      connectStatus.textContent = 'Connecting‚Ä¶';
      try {
        const res = await fetch('https://discord.com/api/v9/users/@me', {
          headers: { Authorization: token }
        });
        if (!res.ok) throw new Error('Invalid token');
        const user = await res.json();
        connectSection.style.display = 'none';
        tabs.style.visibility = 'visible';
        loadServers(token);
      } catch (err) {
        connectStatus.textContent = err.message;
        connectStatus.style.color = 'var(--error)';
      }
    }

    async function loadServers(token) {
      try {
        const res = await fetch('https://discord.com/api/v9/users/@me/guilds', {
          headers: { Authorization: token }
        });
        const guilds = await res.json();
        serverList.innerHTML = guilds
          .map(g => `<li onclick="loadChannels('${token}','${g.id}','${g.name}')">${g.name}</li>`)
          .join('') || '<li style="color:var(--muted)">No servers</li>';
      } catch {
        serverList.innerHTML = '<li style="color:var(--error)">Error loading servers</li>';
      }
    }

    async function loadChannels(token, guildId, guildName) {
      currentServerName.textContent = guildName;
      channelList.innerHTML = '<li style="color:var(--muted)">Loading‚Ä¶</li>';
      try {
        const res = await fetch(`https://discord.com/api/v9/guilds/${guildId}/channels`, {
          headers: { Authorization: token }
        });
        const channels = await res.json();
        channelList.innerHTML = channels
          .filter(c => c.type === 0)
          .map(c => `<li># ${c.name}</li>`).join('') ||
          '<li style="color:var(--muted)">No text channels</li>';
      } catch {
        channelList.innerHTML = '<li style="color:var(--error)">Error loading channels</li>';
      }
    }

    // Placeholder stubs for broadcast & auto-reply
    function selectChannels() {
      selectedChannels.textContent = '‚Ä¶select UI coming soon';
    }
    function broadcast() {
      broadcastStatus.textContent = 'Broadcast stub';
    }
    function updateAutoReply() {
      replyStatus.textContent = 'Auto-reply stub';
    }
  </script>
</body>
</html>
